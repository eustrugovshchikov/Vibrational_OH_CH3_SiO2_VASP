# Vibrational_OH_CH3_SiO2_VASP

**Compute vibrational frequency spectra of OH and CH₃ groups on α‑SiO₂ from VASP trajectories.**

---

## Table of Contents

- [Theory](#theory)  
- [Installation](#installation)  
- [Global Variables](#global-variables)  
- [Examples](#examples)  
- [How to Cite](#how-to-cite)  

---

## Theory

This script extracts vibrational frequencies by applying a Fourier transform to the time‑series data of atomic trajectories generated by VASP molecular dynamics (MD) runs. In brief:

1. **MD Trajectory Output**  
   - Perform a VASP MD simulation and configure XDATCAR to write every ionic step.  
   - Ensure periodic snapshots of Si, O, H, and C atom positions are saved to XDATCAR file.

2. **Signal Preparation**  
   - Select only the OH and CH₃ atoms (by their indices) from the trajectory frames.  
   - Compute displacements for each bond vector as a function of time.

3. **Fourier Transform**  
   - Apply a discrete Fourier transform (via NumPy’s FFT) to each time‑series.  
   - Convert frequency‑domain amplitudes into power spectra, yielding peaks at characteristic vibrational modes.

4. **Spectrum Assembly**  
   - Combine individual group spectra, normalize intensity, and output as text.

---

## Installation
   - Python 3.x (≥ 3.6)  
   - No external Python dependencies beyond the standard library.

## Global Variables

Control analysis behavior via user-defined variables in your environment or `submit.sh` file.

```bash
# ***** USER-DEFINED VARIABLES *****
# Set simulation frame range (modify these numbers before submission)
START_FRAME=5000
FINISH_FRAME=100000
# ***********************************

# Based on the command-line argument (1,2,3,4), the script outputs:
#  1) Mode 1 (only OH): Bonds: H–O and O–Si, Angle: H–O–Si.
#  2) Mode 2 (only CH3): Bonds: C–H (for each H in CH3) and C–Si;
#       Angles: all H–C–H combinations and H–C–Si angles.
#  3) Mode 3 (only surface angles): Angles at the Si center between any two functional groups.
#  4) Mode 4 (all): Both groups’ bonds/angles plus the surface angles.

# Example invocation for Mode 4:
echo "Running find_indices.py to extract H atom indices..."
python find_indices.py 4


Input and output filenames (optional overrides)
INPUT_XDATCAR = "XDATCAR"
OUTPUT_SPECTRUM = "output_average.dat"

```

## Examples

To run an example:

1. **Download and unpack**  
   - Download the `EXAMPLES` folder from this repository.  
   - Unpack the `XDATCAR` file into the same directory.

2. **Edit the SLURM script**  
   - Open the provided `submit.sh` script.  
   - Adjust the `#SBATCH` directives to match your cluster’s account, partition, node, and time limits.  
   - Ensure you load the correct Python module for your environment.

```bash
#!/bin/bash -x 
#SBATCH --account=dcc70
#SBATCH --partition=mylemta
#SBATCH --job-name=FFT
#SBATCH --output=slurm-%x.%N.%j.out 
#SBATCH --error=slurm-%x.%N.%j.err 
#SBATCH --nodes=1
#SBATCH --ntasks=32
#SBATCH --ntasks-per-node=32
#SBATCH --cpus-per-task=1
#SBATCH --time=3-01:00:00
#SBATCH --exclude=cnd[01-04,06-12]

# Load the Python module.
module load python/3.6/anaconda
```
3. **Submit the job**
```bash
sbatch submit.sh
```

After the script runs, the results will be written to `output_average.dat`.


## How to Cite

If you use this code in your work, please cite it using the following BibTeX entry:

```bibtex
@misc{strugovshchikov2025vibrational,
  author       = {Strugovshchikov, Evgenii and Mandrolko, Viktor and Lesnicki, Dominika and  Pastore, Mariachiara and Chaput, Laurent and Isaiev, Mykola},
  title        = {{Vibrational\_OH\_CH3\_SiO2\_VASP}},
  year         = {2025},
  howpublished = {GitHub repository},
  url          = {https://github.com/eustrugovshchikov/Vibrational_OH_CH3_SiO2_VASP},
  note         = {Accessed: May 28, 2025},
}
```

